{% extends 'base.html' %}
{% load widget_tweaks %}
{% load static %}

{% block title %}Edit Snippet{% endblock %}


{% block content %}
<div class="container-lg py-4">
  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h4 fw-semibold text-primary mb-0">Edit Snippet</h1>
    <a href="{% url 'snippet_list' %}" class="btn btn-outline-secondary btn-sm">
      <i class="bi bi-arrow-left"></i> Back to Snippets
    </a>
  </div>

  <!-- Form -->
  <div class="bg-white rounded shadow-sm p-4">
    <form method="post" novalidate>
      {% csrf_token %}

      <div class="mb-3">
        <label for="id_title" class="form-label">Title</label>
        <input type="text" class="form-control" id="id_title" name="title" value="{{ form.title.value }}">
      </div>

      <div class="mb-3">
        <label for="id_language" class="form-label">Language</label>
        {{ form.language|add_class:"form-select" }}
        {% if form.language.errors %}
          <div class="form-text text-danger">{{ form.language.errors|join:" " }}</div>
        {% endif %}
      </div>

      <div class="mb-3">
        <label for="id_description" class="form-label">Description</label>
        <textarea class="form-control" id="id_description" name="description" rows="4">{{ form.description.value }}</textarea>
      </div>

      <div class="mb-3">
        <label for="id_code" class="form-label">Code</label>
        <textarea class="form-control" id="id_code" name="code" rows="10">{{ form.code.value }}</textarea>
      </div>

      <div class="mb-3">
        <label for="id_tags" class="form-label">Tags</label>
        <input type="text" class="form-control" id="id_tags" name="tags" value="{{ form.tags.value }}">
      </div>

      <div class="d-grid">
        <button type="submit" class="btn btn-primary">
          <i class="bi bi-save"></i> Save Changes
        </button>
      </div>
    </form>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const codeField = document.getElementById('id_code');
    codeField.addEventListener('keydown', function (e) {
      if (e.key === 'Tab') {
        e.preventDefault();
        const start = this.selectionStart;
        const end = this.selectionEnd;
        this.value = this.value.substring(0, start) + "\t" + this.value.substring(end);
        this.selectionStart = this.selectionEnd = start + 1;
      }
    });
  });
</script>
{% endblock %}