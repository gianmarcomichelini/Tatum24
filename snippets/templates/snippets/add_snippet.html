{% extends 'tatum24/templates/../../../templates/base.html' %}
{% load widget_tweaks %}
{% load static %}

{% block title %}
    Add a Snippet
{% endblock %}

{% block content %}
<div class="container-lg py-4">
  <header class="mb-4">
    <h1 class="h3 text-primary fw-semibold mb-1">Add a Snippet</h1>
    <p class="text-muted">Use the form below to submit your snippet - all fields are required.</p>
  </header>

  <main>
    <form method="post" action="{% url 'add_snippet' %}?next={% url 'add_snippet' %}" class="bg-white p-4 rounded shadow-sm">
      {% csrf_token %}

      <div class="mb-3">
        <label for="id_title" class="form-label">Title</label>
        {{ form.title|add_class:"form-control" }}
        {% if form.title.errors %}
          <div class="text-danger small">{{ form.title.errors|join:", " }}</div>
        {% endif %}
      </div>

      <div class="mb-3">
        <label for="id_language" class="form-label">Language</label>
        {{ form.language|add_class:"form-select" }}
        {% if form.language.errors %}
          <div class="text-danger small">{{ form.language.errors|join:", " }}</div>
        {% endif %}
      </div>

      <div class="mb-3">
        <label for="id_description" class="form-label">Description</label>
        {{ form.description|add_class:"form-control" }}
        {% if form.description.errors %}
          <div class="text-danger small">{{ form.description.errors|join:", " }}</div>
        {% endif %}
      </div>

      <div class="mb-3">
        <label for="id_code" class="form-label">Code</label>
        {{ form.code|add_class:"form-control font-monospace" }}
        {% if form.code.errors %}
          <div class="text-danger small">{{ form.code.errors|join:", " }}</div>
        {% endif %}
      </div>

      <div class="mb-3">
        <label for="id_tags" class="form-label">Tags</label>
        {{ form.tags|add_class:"form-control" }}
        {% if form.tags.errors %}
          <div class="text-danger small">{{ form.tags.errors|join:", " }}</div>
        {% endif %}
      </div>

      <div class="d-grid mt-4">
        <button type="submit" class="btn btn-primary">Submit</button>
      </div>
    </form>
  </main>

  <footer class="mt-4 text-center">
    <a href="{% url 'home' %}" class="text-decoration-none text-secondary">
      &larr; Back to Home
    </a>
  </footer>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    var codeField = document.getElementById('id_code');
    if (codeField) {
      codeField.addEventListener('keydown', function (e) {
        if (e.key === 'Tab') {
          e.preventDefault();
          var start = this.selectionStart;
          var end = this.selectionEnd;
          this.value = this.value.substring(0, start) + "\t" + this.value.substring(end);
          this.selectionStart = this.selectionEnd = start + 1;
        }
      });
    }
  });
</script>
{% endblock %}